/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
plugins {
  id "com.moowork.node" version "1.2.0"
  id 'org.ajoberstar.git-publish' version '0.3.3'
}

task clean{
  doFirst {
    delete "$rootDir/acollins.pdf"
    println "rm $rootDir/acollins.pdf"
    delete "$rootDir/index.html"
    println "rm $rootDir/index.html"
  }
}

task publish{
  gitPublish {
      // branch will be created if it doesn't exist
      branch = 'master'
  
      // generally, you don't need to touch this
      repoDir = file("$rootDir")

      // message used when committing changes
      commitMessage = 'Publishing a new page' // defaults to 'Generated by gradle-git-publish'
  }
}

task exportHTML(type: NpmTask) {
  logger.info('Export index.html version of resume')
  args = ['run', 'exportHTML'] 
}

task exportPDF(type: NpmTask) {
  logger.info('Export acollins.pdf version of resume')
  args = ['run', 'exportPDF'] 
}

task build {
    dependsOn 'exportHTML'
    dependsOn 'exportPDF'
    tasks.findByName('exportHTML').mustRunAfter 'clean'
    tasks.findByName('exportPDF').mustRunAfter 'clean'
}

task cleanBuildPublish {
    dependsOn 'clean'
    dependsOn 'build'
    dependsOn 'publish'
    tasks.findByName('build').mustRunAfter 'clean'
    tasks.findByName('publish').mustRunAfter 'build'
}